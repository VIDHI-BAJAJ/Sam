class p extends HTMLElement{constructor(){super(),this.geoBanner=this,this.dialog=this.geoBanner.querySelector("modal-redirect"),this.addEventListener("keyup",e=>{e.code.toUpperCase()==="ESCAPE"&&this.close(this.dialog)}),this.addEventListener("click",e=>{e.target===this.dialog&&this.close(this.dialog)}),this.dialog.querySelector("#Stay").addEventListener("click",e=>{e.target===this.dialog.querySelector("#Stay")&&this.close(this.dialog)});let n=!!this.geoBanner.hasAttribute("data-designmode");const r=sessionStorage.getItem("geolocation-popup-shown");(n||!r)&&this.fetchUserCountry(n)}fetchUserCountry(n){fetch("/browsing_context_suggestions.json").then(r=>r.json()).then(r=>{let e=r.detected_values.country.handle,l=!1,t="false",o="false",i="false",s=!1;Shopify.designMode&&n?(l=!0,t=window.shopUrl,o=e,i="TEST"):window.geoLocation.US.includes(e)&&window.shopUrl!=window.domains.US&&window.geoLocation.disable_popup_US!==!0?(l=!0,t=window.domains.US,o="US"):window.geoLocation.JP.includes(e)&&window.shopUrl!=window.domains.JP&&window.geoLocation.disable_popup_JP!==!0?(l=!0,t=window.domains.JP,o="JP"):!window.geoLocation.EU.includes(e)&&!window.geoLocation.US.includes(e)&&!window.geoLocation.JP.includes(e)&&window.geoLocation.disable_popup_EU!==!0&&(l=!0,s=!0,t=window.storeLocator.Url,o="Store Locator"),window.shopUrl==window.domains.EU?i="EU":window.shopUrl==window.domains.US?i="US":window.shopUrl==window.domains.JP?i="JP":i=window.Shopify.country,t!=!1&&l!=!1&&this.initRedirectPopup(t,o,i,s)})}initRedirectPopup(n,r,e,l){this.dialog.querySelector("#Redirect").setAttribute("href",n);let t=n.replace("https://",""),o=this.dialog.querySelector(".geobanner-modal__heading"),i=o.textContent.replace("[current]",e).replace("[target]",t);o.textContent=i;let s=this.dialog.querySelector(".geobanner-modal__text"),u=s.textContent.replace("[current]",e).replace("[target]",t);if(s.textContent=u,l){let a=this.dialog.querySelector("#Redirect"),d=a.textContent.replace("[current]",e).replace("[target]",r);a.textContent=d}else{let a=this.dialog.querySelector("#Redirect"),d=a.textContent.replace("[current]",e).replace("[target]",t);a.textContent=d}let c=this.dialog.querySelector("#Stay"),g=c.textContent.replace("[current]",e).replace("[target]",t);c.textContent=g,this.open(this.dialog)}open(){sessionStorage.setItem("geolocation-popup-shown",!0),this.dialog.setAttribute("open",!0),document.body.classList.add("overflow-hidden"),trapFocus(this.dialog.querySelector('[tabindex="-1"]'),this.dialog.querySelector("#Redirect"))}close(){this.dialog.removeAttribute("open"),document.body.classList.remove("overflow-hidden")}}customElements.define("geo-banner",p);
//# sourceMappingURL=/cdn/shop/t/28/assets/novicell_geobanner-da51d77e.js.map
